<?altova_samplexml i:\testarea\dup2.xml?>
<!--
    Copyright (c) 1999-2011, International Business Machines
    Corporation and others.  All rights reserved.
-->

<!-- &nbsp; does not exists in XPath, so defined as the real unicode character 160
     which is the non breaking space character and provides exactly the same result than using &nbsp; -->
     
<!DOCTYPE xsl:stylesheet 
	[
		<!ENTITY nbsp "&#160;">
	]>

<!-- calrelp.xsl

	Author: Gerhard Queck

	Purpose: Convert an wordcount report to HTML
-->
<xsl:stylesheet version="1.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform">

	<xsl:output method="html" encoding="utf-8"/>

	<xsl:template match="/">
		<html>
<!-- <head> required to put <META http-equiv="Content-Type" content="text/html; charset=utf-8">
     generated by output encoding attribute -->
     		<head></head>
			<body>
<!--				<xsl:call-template name="reportheader" /> -->
				<xsl:choose>
					<xsl:when test="/tmwordcount/description/report/@counted = 'Source' ">
						<xsl:call-template name="source" />
					</xsl:when>
					<xsl:when test="/tmwordcount/description/report/@counted = 'Target' ">
						<xsl:call-template name="target" />
					</xsl:when>
					<xsl:when test="/tmwordcount/description/report/@counted = 'MemoryMatch' ">
						<xsl:call-template name="memmatch" />
					</xsl:when>
					<xsl:when test="/tmwordcount/description/report/@counted = 'Duplicates' ">
						 <xsl:if test="/tmwordcount/documents/document[1]/wordcount/words[@type='Markup']/@count!=''">
							<xsl:call-template name="dups" />
						 </xsl:if>
						 <xsl:if test="/tmwordcount/documents/document[1]/wordcount/words[@type='Exact']/@count!=''">
							<xsl:call-template name="dups2" />
						 </xsl:if>
					</xsl:when>
					<xsl:when test="/tmwordcount/description/report/@counted = 'FuzzyMatch' ">
						<xsl:call-template name="fuzzymatch" />
					</xsl:when>
				</xsl:choose>
			</body>
		</html>
	</xsl:template>
	

<xsl:template name = "source" >
	<P><BR/></P>
	<TABLE border="1">
	   <TBODY>
		  <TR>
			 <TD bgcolor="#d3d3d3">Word count results:</TD>
			 <TD bgcolor="#f7f7f7">Original</TD>
		  </TR>
		  <TR>
			 <TD bgcolor="#d3d3d3">Folder:</TD>
			 <TD bgcolor="#f7f7f7"><xsl:value-of select="/tmwordcount/description/folder/@nameLong"/></TD>
		  </TR>
		  <TR>
			 <TD bgcolor="#d3d3d3">Report Generated at:</TD>
			 <TD bgcolor="#f7f7f7">
				 <xsl:value-of select="/tmwordcount/description/report/@generatedDate"/>
				 &nbsp;
				 <xsl:value-of select="/tmwordcount/description/report/@generatedTime"/>
			</TD>
		  </TR>
	   </TBODY>
	</TABLE>
	<P>
	<TABLE border="1">
	   <TBODY>
		  <TR>
			 <TD bgcolor="#d3d3d3">Documents</TD>
			 <TD bgcolor="#d3d3d3">Untranslated</TD>
			 <TD bgcolor="#d3d3d3">Markup</TD>
			 <TD bgcolor="#d3d3d3">Total</TD>
		  </TR>
			<xsl:for-each select="/tmwordcount/documents/document">
				<xsl:call-template name="source-one-document">
					<xsl:with-param name="document" select="." />
				</xsl:call-template>
			</xsl:for-each>
		  <TR>
			 <TD bgcolor="#d3d3d3">Total</TD>
			 <TD bgcolor="#d3d3d3"><xsl:value-of select="/tmwordcount/summary/wordcount/words[@type='Untranslated']/@count"/></TD>
			 <TD bgcolor="#d3d3d3"><xsl:value-of select="/tmwordcount/summary/wordcount/words[@type='Markup']/@count"/></TD>
			 <TD bgcolor="#d3d3d3"><xsl:value-of select="/tmwordcount/summary/wordcount/words[@type='Total']/@count"/></TD>
		  </TR>
	   </TBODY>
	</TABLE>
	</P>

</xsl:template>

<xsl:template name = "source-one-document" >
	<xsl:param name="document"></xsl:param>
  <TR>
	 <TD><xsl:value-of select="$document/@nameLong"/></TD>
	 <TD><xsl:value-of select="$document/wordcount/words[@type='Untranslated']/@count"/></TD>
	 <TD><xsl:value-of select="$document/wordcount/words[@type='Markup']/@count"/></TD>
	 <TD><xsl:value-of select="$document/wordcount/words[@type='Total']/@count"/></TD>
  </TR>
</xsl:template>
	
<xsl:template name = "target" >
	<P><BR/></P>
	<TABLE border="1">
	   <TBODY>
		  <TR>
			 <TD bgcolor="#d3d3d3">Word count results:</TD>
			 <TD bgcolor="#f7f7f7">Translation</TD>
		  </TR>
		  <TR>
			 <TD bgcolor="#d3d3d3">Folder:</TD>
			 <TD bgcolor="#f7f7f7"><xsl:value-of select="/tmwordcount/description/folder/@nameLong"/></TD>
		  </TR>
		  <TR>
			 <TD bgcolor="#d3d3d3">Report Generated at:</TD>
			 <TD bgcolor="#f7f7f7">
				 <xsl:value-of select="/tmwordcount/description/report/@generatedDate"/>
				 &nbsp;
				 <xsl:value-of select="/tmwordcount/description/report/@generatedTime"/>
			</TD>
		  </TR>
	   </TBODY>
	</TABLE>
	<P>
	<TABLE border="1">
	   <TBODY>
		  <TR>
			 <TD bgcolor="#d3d3d3">Documents</TD>
			 <TD bgcolor="#d3d3d3">Translated</TD>
			 <TD bgcolor="#d3d3d3">Untranslated</TD>
			 <TD bgcolor="#d3d3d3">Target Words</TD>
			 <TD bgcolor="#d3d3d3">Markup</TD>
		  </TR>
			<xsl:for-each select="/tmwordcount/documents/document">
				<xsl:call-template name="target-one-document">
					<xsl:with-param name="document" select="." />
				</xsl:call-template>
			</xsl:for-each>
		  <TR>
			 <TD bgcolor="#d3d3d3">Total</TD>
			 <TD bgcolor="#d3d3d3"><xsl:value-of select="/tmwordcount/summary/wordcount/words[@type='Translated']/@count"/></TD>
			 <TD bgcolor="#d3d3d3"><xsl:value-of select="/tmwordcount/summary/wordcount/words[@type='Untranslated']/@count"/></TD>
			 <TD bgcolor="#d3d3d3"><xsl:value-of select="/tmwordcount/summary/wordcount/words[@type='TargetWords']/@count"/></TD>
			 <TD bgcolor="#d3d3d3"><xsl:value-of select="/tmwordcount/summary/wordcount/words[@type='Markup']/@count"/></TD>
		  </TR>
	   </TBODY>
	</TABLE>
	</P>

</xsl:template>

<xsl:template name = "target-one-document" >
	<xsl:param name="document"></xsl:param>
  <TR>
	 <TD><xsl:value-of select="$document/@nameLong"/></TD>
	 <TD><xsl:value-of select="$document/wordcount/words[@type='Translated']/@count"/></TD>
	 <TD><xsl:value-of select="$document/wordcount/words[@type='Untranslated']/@count"/></TD>
	 <TD><xsl:value-of select="$document/wordcount/words[@type='TargetWords']/@count"/></TD>
	 <TD><xsl:value-of select="$document/wordcount/words[@type='Markup']/@count"/></TD>
  </TR>
</xsl:template>
	
<xsl:template name = "memmatch" >
	<P><BR/></P>
	<TABLE border="1">
	   <TBODY>
		  <TR>
			 <TD bgcolor="#d3d3d3">Word count results:</TD>
			 <TD bgcolor="#f7f7f7">Translation Memory Matches</TD>
		  </TR>
		  <TR>
			 <TD bgcolor="#d3d3d3">Folder:</TD>
			 <TD bgcolor="#f7f7f7"><xsl:value-of select="/tmwordcount/description/folder/@nameLong"/></TD>
		  </TR>
		  <TR>
			 <TD bgcolor="#d3d3d3">Report Generated at:</TD>
			 <TD bgcolor="#f7f7f7">
				 <xsl:value-of select="/tmwordcount/description/report/@generatedDate"/>
				 &nbsp;
				 <xsl:value-of select="/tmwordcount/description/report/@generatedTime"/>
			</TD>
		  </TR>
	   </TBODY>
	</TABLE>
	<P>
	<TABLE border="1">
	   <TBODY>
		  <TR>
			 <TD bgcolor="#d3d3d3">Documents</TD>
			 <TD bgcolor="#d3d3d3">Total</TD>
			 <TD bgcolor="#d3d3d3">Exact-Exact</TD>
			 <TD bgcolor="#d3d3d3">Exact (1)</TD>
			 <TD bgcolor="#d3d3d3">Exact (2)</TD>
			 <TD bgcolor="#d3d3d3">Fuzzy</TD>
 			 <xsl:if test="/tmwordcount/documents/document[1]/wordcount/words[@type='Replace']/@count!=''">
				 <TD bgcolor="#d3d3d3">Replace</TD>
				 <TD bgcolor="#d3d3d3">Fuzzy Replace</TD>
 			 </xsl:if>
			 <TD bgcolor="#d3d3d3">Machine Match</TD>
			 <TD bgcolor="#d3d3d3">No Match</TD>
		  </TR>
			<xsl:for-each select="/tmwordcount/documents/document">
				<xsl:call-template name="memmatch-one-document">
					<xsl:with-param name="document" select="." />
				</xsl:call-template>
			</xsl:for-each>
		  <TR>
			 <TD bgcolor="#d3d3d3">Total</TD>
			 <TD bgcolor="#d3d3d3"><xsl:value-of select="/tmwordcount/summary/wordcount/words[@type='Total']/@count"/></TD>
			 <TD bgcolor="#d3d3d3"><xsl:value-of select="/tmwordcount/summary/wordcount/words[@type='ExactExact']/@count"/></TD>
			 <TD bgcolor="#d3d3d3"><xsl:value-of select="/tmwordcount/summary/wordcount/words[@type='Exact-1']/@count"/></TD>
			 <TD bgcolor="#d3d3d3"><xsl:value-of select="/tmwordcount/summary/wordcount/words[@type='Exact-2']/@count"/></TD>
			 <TD bgcolor="#d3d3d3"><xsl:value-of select="/tmwordcount/summary/wordcount/words[@type='Fuzzy']/@count"/></TD>
 			 <xsl:if test="/tmwordcount/documents/document[1]/wordcount/words[@type='Replace']/@count!=''">
				 <TD bgcolor="#d3d3d3"><xsl:value-of select="/tmwordcount/summary/wordcount/words[@type='Replace']/@count"/></TD>
				 <TD bgcolor="#d3d3d3"><xsl:value-of select="/tmwordcount/summary/wordcount/words[@type='FuzzyRepl']/@count"/></TD>
 			 </xsl:if>
			 <TD bgcolor="#d3d3d3"><xsl:value-of select="/tmwordcount/summary/wordcount/words[@type='MachMatch']/@count"/></TD>
			 <TD bgcolor="#d3d3d3"><xsl:value-of select="/tmwordcount/summary/wordcount/words[@type='NoMatch']/@count"/></TD>
		  </TR>
	   </TBODY>
	</TABLE>
	</P>

</xsl:template>

<xsl:template name = "memmatch-one-document" >
	<xsl:param name="document"></xsl:param>
  <TR>
	 <TD><xsl:value-of select="$document/@nameLong"/></TD>
	 <TD><xsl:value-of select="$document/wordcount/words[@type='Total']/@count"/></TD>
	 <TD><xsl:value-of select="$document/wordcount/words[@type='ExactExact']/@count"/></TD>
	 <TD><xsl:value-of select="$document/wordcount/words[@type='Exact-1']/@count"/></TD>
	 <TD><xsl:value-of select="$document/wordcount/words[@type='Exact-2']/@count"/></TD>
	 <TD><xsl:value-of select="$document/wordcount/words[@type='Fuzzy']/@count"/></TD>
	 <xsl:if test="$document/wordcount/words[@type='Replace']/@count!=''">
		 <TD><xsl:value-of select="$document/wordcount/words[@type='Replace']/@count"/></TD>
		 <TD><xsl:value-of select="$document/wordcount/words[@type='FuzzyRepl']/@count"/></TD>
	 </xsl:if>
	 <TD><xsl:value-of select="$document/wordcount/words[@type='MachMatch']/@count"/></TD>
	 <TD><xsl:value-of select="$document/wordcount/words[@type='NoMatch']/@count"/></TD>
  </TR>
</xsl:template>
	
<xsl:template name = "dups" >
	<P><BR/></P>
	<TABLE border="1">
	   <TBODY>
		  <TR>
			 <TD bgcolor="#d3d3d3">Word count results:</TD>
			 <TD bgcolor="#f7f7f7">Duplicate Words</TD>
		  </TR>
		  <TR>
			 <TD bgcolor="#d3d3d3">Folder:</TD>
			 <TD bgcolor="#f7f7f7"><xsl:value-of select="/tmwordcount/description/folder/@nameLong"/></TD>
		  </TR>
		  <TR>
			 <TD bgcolor="#d3d3d3">Report Generated at:</TD>
			 <TD bgcolor="#f7f7f7">
				 <xsl:value-of select="/tmwordcount/description/report/@generatedDate"/>
				 &nbsp;
				 <xsl:value-of select="/tmwordcount/description/report/@generatedTime"/>
			</TD>
		  </TR>
	   </TBODY>
	</TABLE>
	<P>
	<TABLE border="1">
	   <TBODY>
		  <TR>
			 <TD bgcolor="#d3d3d3">Documents</TD>
			 <TD bgcolor="#d3d3d3">Translated</TD>
			 <TD bgcolor="#d3d3d3">Untranslated</TD>
			 <TD bgcolor="#d3d3d3">Duplicate Words</TD>
			 <TD bgcolor="#d3d3d3">To Be Translated</TD>
			 <TD bgcolor="#d3d3d3">Markup</TD>
		  </TR>
			<xsl:for-each select="/tmwordcount/documents/document">
				<xsl:call-template name="dups-one-document">
					<xsl:with-param name="document" select="." />
				</xsl:call-template>
			</xsl:for-each>
		  <TR>
			 <TD bgcolor="#d3d3d3">Total</TD>
			 <TD bgcolor="#d3d3d3"><xsl:value-of select="/tmwordcount/summary/wordcount/words[@type='Translated']/@count"/></TD>
			 <TD bgcolor="#d3d3d3"><xsl:value-of select="/tmwordcount/summary/wordcount/words[@type='Untranslated']/@count"/></TD>
			 <TD bgcolor="#d3d3d3"><xsl:value-of select="/tmwordcount/summary/wordcount/words[@type='DuplicateWords']/@count"/></TD>
			 <TD bgcolor="#d3d3d3"><xsl:value-of select="/tmwordcount/summary/wordcount/words[@type='ToBeTranslated']/@count"/></TD>
			 <TD bgcolor="#d3d3d3"><xsl:value-of select="/tmwordcount/summary/wordcount/words[@type='Markup']/@count"/></TD>
		  </TR>
	   </TBODY>
	</TABLE>
	</P>

</xsl:template>

<xsl:template name = "dups-one-document" >
	<xsl:param name="document"></xsl:param>
  <TR>
	 <TD><xsl:value-of select="$document/@nameLong"/></TD>
	 <TD><xsl:value-of select="$document/wordcount/words[@type='Translated']/@count"/></TD>
	 <TD><xsl:value-of select="$document/wordcount/words[@type='Untranslated']/@count"/></TD>
	 <TD><xsl:value-of select="$document/wordcount/words[@type='DuplicateWords']/@count"/></TD>
	 <TD><xsl:value-of select="$document/wordcount/words[@type='ToBeTranslated']/@count"/></TD>
	 <TD><xsl:value-of select="$document/wordcount/words[@type='Markup']/@count"/></TD>
  </TR>
</xsl:template>
	
<xsl:template name = "dups2" >
	<P><BR/></P>
	<TABLE border="1">
	   <TBODY>
		  <TR>
			 <TD bgcolor="#d3d3d3">Word count results:</TD>
			 <TD bgcolor="#f7f7f7">Duplicate Words</TD>
		  </TR>
		  <TR>
			 <TD bgcolor="#d3d3d3">Folder:</TD>
			 <TD bgcolor="#f7f7f7"><xsl:value-of select="/tmwordcount/description/folder/@nameLong"/></TD>
		  </TR>
		  <TR>
			 <TD bgcolor="#d3d3d3">Report Generated at:</TD>
			 <TD bgcolor="#f7f7f7">
				 <xsl:value-of select="/tmwordcount/description/report/@generatedDate"/>
				 &nbsp;
				 <xsl:value-of select="/tmwordcount/description/report/@generatedTime"/>
			</TD>
		  </TR>
	   </TBODY>
	</TABLE>
	<P>
	<TABLE border="1">
	   <TBODY>
		  <TR>
			 <TD bgcolor="#d3d3d3">Documents</TD>
			 <TD bgcolor="#d3d3d3">Duplicate Words (Repetitions)</TD>
			 <TD bgcolor="#d3d3d3">95-99% Fuzzy</TD>
			 <TD bgcolor="#d3d3d3">75-94% Fuzzy</TD>
			 <TD bgcolor="#d3d3d3">0-74% Fuzzy</TD>
			 <TD bgcolor="#d3d3d3">Total Untranslated</TD>
			 <TD bgcolor="#d3d3d3">Exact Matches (100% Matches)</TD>
		  </TR>
			<xsl:for-each select="/tmwordcount/documents/document">
				<xsl:call-template name="dups2-one-document">
					<xsl:with-param name="document" select="." />
				</xsl:call-template>
			</xsl:for-each>
		  <TR>
			 <TD bgcolor="#d3d3d3">Total</TD>
			 <TD bgcolor="#d3d3d3"><xsl:value-of select="/tmwordcount/summary/wordcount/words[@type='DuplicateWords']/@count"/></TD>
			 <TD bgcolor="#d3d3d3"><xsl:value-of select="/tmwordcount/summary/wordcount/words[@type='Fuzzy9599']/@count"/></TD>
			 <TD bgcolor="#d3d3d3"><xsl:value-of select="/tmwordcount/summary/wordcount/words[@type='Fuzzy7594']/@count"/></TD>
			 <TD bgcolor="#d3d3d3"><xsl:value-of select="/tmwordcount/summary/wordcount/words[@type='Fuzzy0074']/@count"/></TD>
			 <TD bgcolor="#d3d3d3"><xsl:value-of select="/tmwordcount/summary/wordcount/words[@type='Total']/@count"/></TD>
			 <TD bgcolor="#d3d3d3"><xsl:value-of select="/tmwordcount/summary/wordcount/words[@type='Exact']/@count"/></TD>
		  </TR>
	   </TBODY>
	</TABLE>
	</P>

</xsl:template>

<xsl:template name = "dups2-one-document" >
	<xsl:param name="document"></xsl:param>
  <TR>
	 <TD><xsl:value-of select="$document/@nameLong"/></TD>
	 <TD><xsl:value-of select="$document/wordcount/words[@type='DuplicateWords']/@count"/></TD>
	 <TD><xsl:value-of select="$document/wordcount/words[@type='Fuzzy9599']/@count"/></TD>
	 <TD><xsl:value-of select="$document/wordcount/words[@type='Fuzzy7594']/@count"/></TD>
	 <TD><xsl:value-of select="$document/wordcount/words[@type='Fuzzy0074']/@count"/></TD>
	 <TD><xsl:value-of select="$document/wordcount/words[@type='Total']/@count"/></TD>
	 <TD><xsl:value-of select="$document/wordcount/words[@type='Exact']/@count"/></TD>
  </TR>
</xsl:template>
	
<xsl:template name = "fuzzymatch" >
	<P><BR/></P>
	<TABLE border="1">
	   <TBODY>
		  <TR>
			 <TD bgcolor="#d3d3d3">Word count results:</TD>
			 <TD bgcolor="#f7f7f7">Fuzzy Match</TD>
		  </TR>
		  <TR>
			 <TD bgcolor="#d3d3d3">Folder:</TD>
			 <TD bgcolor="#f7f7f7"><xsl:value-of select="/tmwordcount/description/folder/@nameLong"/></TD>
		  </TR>
		  <TR>
			 <TD bgcolor="#d3d3d3">Report Generated at:</TD>
			 <TD bgcolor="#f7f7f7">
				 <xsl:value-of select="/tmwordcount/description/report/@generatedDate"/>
				 &nbsp;
				 <xsl:value-of select="/tmwordcount/description/report/@generatedTime"/>
			</TD>
		  </TR>
	   </TBODY>
	</TABLE>
	<P>
	<TABLE border="1">
	   <TBODY>
		  <TR>
			 <TD bgcolor="#d3d3d3">Documents</TD>
			 <TD bgcolor="#d3d3d3">Total</TD>
			 <TD bgcolor="#d3d3d3">Class-zero</TD>
			 <TD bgcolor="#d3d3d3">Class-1</TD>
			 <TD bgcolor="#d3d3d3">Class-2</TD>
			 <TD bgcolor="#d3d3d3">Class-3</TD>
			 <TD bgcolor="#d3d3d3">Class-4</TD>
			 <TD bgcolor="#d3d3d3">Class-5</TD>
			 <TD bgcolor="#d3d3d3">Class-6up</TD>
		  </TR>
			<xsl:for-each select="/tmwordcount/documents/document">
				<xsl:call-template name="fuzzymatch-one-document">
					<xsl:with-param name="document" select="." />
				</xsl:call-template>
			</xsl:for-each>
		  <TR>
			 <TD bgcolor="#d3d3d3">Total</TD>
			 <TD bgcolor="#d3d3d3"><xsl:value-of select="/tmwordcount/summary/wordcount/words[@type='Total']/@count"/></TD>
			 <TD bgcolor="#d3d3d3"><xsl:value-of select="/tmwordcount/summary/wordcount/words[@type='Class-zero']/@count"/></TD>
			 <TD bgcolor="#d3d3d3"><xsl:value-of select="/tmwordcount/summary/wordcount/words[@type='Class-1']/@count"/></TD>
			 <TD bgcolor="#d3d3d3"><xsl:value-of select="/tmwordcount/summary/wordcount/words[@type='Class-2']/@count"/></TD>
			 <TD bgcolor="#d3d3d3"><xsl:value-of select="/tmwordcount/summary/wordcount/words[@type='Class-3']/@count"/></TD>
			 <TD bgcolor="#d3d3d3"><xsl:value-of select="/tmwordcount/summary/wordcount/words[@type='Class-4']/@count"/></TD>
			 <TD bgcolor="#d3d3d3"><xsl:value-of select="/tmwordcount/summary/wordcount/words[@type='Class-5']/@count"/></TD>
			 <TD bgcolor="#d3d3d3"><xsl:value-of select="/tmwordcount/summary/wordcount/words[@type='Class-6up']/@count"/></TD>
		  </TR>
	   </TBODY>
	</TABLE>
	</P>

</xsl:template>

<xsl:template name = "fuzzymatch-one-document" >
	<xsl:param name="document"></xsl:param>
  <TR>
	 <TD><xsl:value-of select="$document/@nameLong"/></TD>
	 <TD><xsl:value-of select="$document/wordcount/words[@type='Total']/@count"/></TD>
	 <TD><xsl:value-of select="$document/wordcount/words[@type='Class-zero']/@count"/></TD>
	 <TD><xsl:value-of select="$document/wordcount/words[@type='Class-1']/@count"/></TD>
	 <TD><xsl:value-of select="$document/wordcount/words[@type='Class-2']/@count"/></TD>
	 <TD><xsl:value-of select="$document/wordcount/words[@type='Class-3']/@count"/></TD>
	 <TD><xsl:value-of select="$document/wordcount/words[@type='Class-4']/@count"/></TD>
	 <TD><xsl:value-of select="$document/wordcount/words[@type='Class-5']/@count"/></TD>
	 <TD><xsl:value-of select="$document/wordcount/words[@type='Class-6up']/@count"/></TD>
  </TR>
</xsl:template>

	
</xsl:stylesheet>
